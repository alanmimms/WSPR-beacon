<!DOCTYPE html>
<html>
<head><title>Settings</title></head>
<body>
  <main>
    <h2>Beacon Identity</h2>
    <form id="settings-form">
      <label for="callsign">Callsign:</label><br>
      <input type="text" id="callsign" name="callsign"><br>
      <label for="locator">Maidenhead Locator (4â€“6 chars):</label><br>
      <input type="text" id="locator" name="locator"><br>
      <label for="power">Power (watts):</label><br>
      <input type="number" id="power" name="power" step="0.01"><br><br>
      <button type="submit">Save Settings</button>
    </form>
    <p id="settings-message"></p>
    <script>
      document.getElementById('settings-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        const payload = {
          callsign: document.getElementById('callsign').value,
          locator: document.getElementById('locator').value,
          power: parseFloat(document.getElementById('power').value)
        };
        const res = await fetch('/api/settings', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });
        document.getElementById('settings-message').textContent = res.ok ? 'Saved!' : 'Error saving.';
      });

      fetch('/api/status.json').then(res => res.json()).then(data => {
        document.getElementById('callsign').value = data.callsign || "";
        document.getElementById('locator').value = data.locator || "";
        document.getElementById('power').value = data.power || "";
      });
    </script>
  </main>
  <script src="layout.js"></script>
</body>
</html>
